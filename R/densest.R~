ix <- 1:nrow(my.Y);

lix <- length(ix);

my.dists <- data.frame(index = ix,
                       weighted.mean = numeric(lix),
                       mean = numeric(lix),
                       max = numeric(lix));

for(i in 1:nrow(my.dists)){

    tmp <- as.numeric(diss(matrix(my.Y[i,],
                                  ncol=ncol(my.Y)),
                           matrix(my.Y[-i,],
                                  ncol = ncol(my.Y)),
                           method = "procrustes",
                           init.info = 2));

    temp <- neighbor.density(tmp,
                             2,
                             rank(tmp),
                             length(tmp));

    my.dists$weighted.mean[i] <- exp(weighted.mean(log(temp),
                                                   inverse.frequency(my.groups[-i])));

    my.dists$mean[i] <- exp(mean(log(temp)));

    my.dists$max[i] <- max(temp);
 }
